var corpDir=window.corpDir||{};corpDir.common=function(){return{globals:{corpDirWebPartId:"corp-dir-webpart",corpDirControlsId:"corp-dir-controls",corpDirActiveLetterAttr:"data-active-letter",corpDirConfigToggleId:"#corp-dir-config-toggle",corpDirConfigPanelId:"#corp-dir-config-panel",corpDirConfigPanelMessageId:"#corp-dir-config-panel-message",corpDirButtonColorPickerId:"button-color-picker",corpDirButtonHoverColorPickerId:"button-hover-color-picker",corpDirButtonColorPropertyBagKey:"CorpDirButtonColor",corpDirButtonHoverColorPropertyBagKey:"CorpDirButtonHoverColor"},messageType:{information:"information",success:"success",error:"error"}}}();corpDir=window.corpDir||{};corpDir.controls=function(){var n=function(){var i=document.getElementById(corpDir.common.globals.corpDirControlsId),t=i.getAttribute(corpDir.common.globals.corpDirActiveLetterAttr),n;t&&(n=document.getElementById(t),n&&(n.className=n.className.split(" ")[0]))},t=function(t){var f=document.getElementById(corpDir.common.globals.corpDirControlsId),e="letter-"+t,l=f.getAttribute(corpDir.common.globals.corpDirActiveLetterAttr),o,i,s,r,u,h,c;n();t===""||t.length===0||e===l?(i="*",f.setAttribute(corpDir.common.globals.corpDirActiveLetterAttr,"")):(s=document.getElementById(e),s.className=s.className+" active",f.setAttribute(corpDir.common.globals.corpDirActiveLetterAttr,e),i="LastName:"+t+"*");r="Default=";u=window.location.hash.substring(1);u.length>0&&u.indexOf(r)!==-1?(h=decodeURIComponent(u.replace(/\+/g," ")),c=JSON.parse(h.substring(h.indexOf(r)+r.length)),c.k=i,o={Default:JSON.stringify(c)}):o={Default:'{"k": "'+i+'"}'};ajaxNavigate.update(null,o)},i=function(){var n=document.getElementById(corpDir.common.globals.corpDirControlsId);n&&(n.className=n.className.split(" ")[0])};return{init:i,search:t}}();corpDir=window.corpDir||{};corpDir.config=function(){var i=function(){var t=new SP.ClientContext.get_current,i=t.get_web().get_currentUser();t.load(i);t.executeQueryAsync(function(){i.get_isSiteAdmin()&&$jQCorpDir(corpDir.common.globals.corpDirConfigToggleId).removeClass("init-hide")},function(){n("Unable to set admin toggle",corpDir.common.messageType.error)})},r=function(){var f=document.getElementById(corpDir.common.globals.corpDirButtonColorPickerId).jscolor.toHEXString(),e=document.getElementById(corpDir.common.globals.corpDirButtonHoverColorPickerId).jscolor.toHEXString(),i=new SP.ClientContext.get_current,r=i.get_web(),u=r.get_allProperties();u.set_item(corpDir.common.globals.corpDirButtonColorPropertyBagKey,f);u.set_item(corpDir.common.globals.corpDirButtonHoverColorPropertyBagKey,e);r.update();i.executeQueryAsync(function(){n("Saved Sucessfully.",corpDir.common.messageType.success);t()},function(){n("Error Saving.",corpDir.common.messageType.success)})},n=function(n,t){t||(t=corpDir.common.messageType.information);$jQCorpDir(corpDir.common.globals.corpDirConfigPanelMessageId).attr("type",t).empty().text(n)},u=function(){$jQCorpDir(corpDir.common.globals.corpDirConfigPanelId).slideToggle().toggleClass("opened")},t=function(){var t=$jQCorpDir.Deferred(),i=new SP.ClientContext.get_current,u=i.get_web(),r=u.get_allProperties();return i.load(r),i.executeQueryAsync(function(){var i=r.get_fieldValues()[corpDir.common.globals.corpDirButtonColorPropertyBagKey],n;i&&(document.getElementById(corpDir.common.globals.corpDirButtonColorPickerId).jscolor.fromString(i),$jQCorpDir("<style/>",{text:".corp-dir-webpart .corp-dir-controls .letter { background-color: "+i+"}"}).appendTo("head"));n=r.get_fieldValues()[corpDir.common.globals.corpDirButtonHoverColorPropertyBagKey];n&&(document.getElementById(corpDir.common.globals.corpDirButtonHoverColorPickerId).jscolor.fromString(n),$jQCorpDir("<style/>",{text:".corp-dir-webpart .corp-dir-controls .letter:hover,.corp-dir-webpart .corp-dir-controls .letter.active { background-color: "+n+"}"}).appendTo("head"));t.resolve()},function(){n("error retrieving property bag values",corpDir.common.messageType.success);t.reject()}),t.promise()},f=function(){if(!($jQCorpDir(corpDir.common.globals.corpDirConfigPanelId).length<=0)){var n=t();$jQCorpDir.when(n).always(function(){corpDir.controls.init()});i()}};return{toggle:u,save:r,init:f}}();ExecuteOrDelayUntilScriptLoaded(corpDir.config.init,"sp.js");
//# sourceMappingURL=corp-dir.min.js.map
